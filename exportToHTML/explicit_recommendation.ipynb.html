<html>
<head>
<title>explicit_recommendation.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #f8f8f2; font-weight: normal; font-style: normal; }
.s0 { color: rgb(248,248,242); }
</style>
</head>
<BODY BGCOLOR="#272822">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
explicit_recommendation.ipynb</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">{ 
 &quot;cells&quot;: [ 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: { 
    &quot;collapsed&quot;: true 
   }, 
   &quot;source&quot;: [ 
    &quot;# Building a Movie Recommendation System with Spark MLlib&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Import required libraries&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 1, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [], 
   &quot;source&quot;: [ 
    &quot;import subprocess\n&quot;, 
    &quot;import findspark\n&quot;, 
    &quot;findspark.init()\n&quot;, 
    &quot;from pyspark.sql import SparkSession\n&quot;, 
    &quot;from pyspark.ml.evaluation import RegressionEvaluator\n&quot;, 
    &quot;from pyspark.ml.recommendation import ALS\n&quot;, 
    &quot;from pyspark.sql import Row\n&quot;, 
    &quot;\n&quot;, 
    &quot;spark = SparkSession \\\n&quot;, 
    &quot;    .builder \\\n&quot;, 
    &quot;    .appName(\&quot;bitcoins\&quot;) \\\n&quot;, 
    &quot;    .config(\&quot;spark.som.config.option\&quot;, \&quot;some-value\&quot;) \\\n&quot;, 
    &quot;    .getOrCreate()&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Download/Unzip the MovieLens 1M dataset from http://grouplens.org/datasets/movielens&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 2, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;data&quot;: { 
      &quot;text/plain&quot;: [ 
       &quot;1&quot; 
      ] 
     }, 
     &quot;execution_count&quot;: 2, 
     &quot;metadata&quot;: {}, 
     &quot;output_type&quot;: &quot;execute_result&quot; 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;subprocess.call([\&quot;wget\&quot;, \&quot;http://files.grouplens.org/datasets/movielens/ml-1m.zip\&quot;])\n&quot;, 
    &quot;subprocess.call([\&quot;unzip\&quot;, \&quot;ml-1m.zip\&quot;])&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Read and Convert ratings data to a DataFrame&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 3, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [], 
   &quot;source&quot;: [ 
    &quot;lines = spark.read.text(\&quot;./ml-1m/ratings.dat\&quot;).rdd\n&quot;, 
    &quot;parts = lines.map(lambda row: row.value.split(\&quot;::\&quot;))\n&quot;, 
    &quot;ratingsRDD = parts.map(lambda p: Row(userId=int(p[0]), movieId=int(p[1]),\n&quot;, 
    &quot;                                     rating=float(p[2]), timestamp=int(p[3])))\n&quot;, 
    &quot;ratings = spark.createDataFrame(ratingsRDD)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Show the number of ratings in the dataset&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 4, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;Number of ratings = 1000209\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;print(\&quot;Number of ratings = \&quot; + str(ratings.count()))&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Show a sample of the Ratings DataFrame&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 5, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;+-------+------+---------+------+\n&quot;, 
      &quot;|movieId|rating|timestamp|userId|\n&quot;, 
      &quot;+-------+------+---------+------+\n&quot;, 
      &quot;|   2908|   5.0|977895809|    68|\n&quot;, 
      &quot;|   3730|   5.0|978554445|   173|\n&quot;, 
      &quot;|   2917|   2.0|976301830|   456|\n&quot;, 
      &quot;|    589|   4.0|976161565|   526|\n&quot;, 
      &quot;|   2348|   3.0|976207524|   533|\n&quot;, 
      &quot;|   1285|   4.0|979154572|   588|\n&quot;, 
      &quot;|   1206|   4.0|980628867|   711|\n&quot;, 
      &quot;|   3361|   4.0|975510209|   730|\n&quot;, 
      &quot;|   3203|   5.0|975435824|   779|\n&quot;, 
      &quot;|   1196|   4.0|975356701|   843|\n&quot;, 
      &quot;+-------+------+---------+------+\n&quot;, 
      &quot;only showing top 10 rows\n&quot;, 
      &quot;\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;ratings.sample(False, 0.0001, seed=0).show(10)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Show sample number of ratings per user&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 6, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;+------+--------------+\n&quot;, 
      &quot;|userId|No. of ratings|\n&quot;, 
      &quot;+------+--------------+\n&quot;, 
      &quot;|    26|           400|\n&quot;, 
      &quot;|    29|           108|\n&quot;, 
      &quot;|   474|           318|\n&quot;, 
      &quot;|   964|            78|\n&quot;, 
      &quot;|  1677|            43|\n&quot;, 
      &quot;|  1697|           354|\n&quot;, 
      &quot;|  1806|           214|\n&quot;, 
      &quot;|  1950|           137|\n&quot;, 
      &quot;|  2040|            46|\n&quot;, 
      &quot;|  2214|            81|\n&quot;, 
      &quot;+------+--------------+\n&quot;, 
      &quot;only showing top 10 rows\n&quot;, 
      &quot;\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;grouped_ratings = ratings.groupBy(\&quot;userId\&quot;).count().withColumnRenamed(\&quot;count\&quot;, \&quot;No. of ratings\&quot;)\n&quot;, 
    &quot;grouped_ratings.show(10)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Show the number of users in the dataset&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 7, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;Number of users = 6040\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;print(\&quot;Number of users = \&quot; + str(grouped_ratings.count()))&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Split Ratings data into Training (80%) and Test (20%) datasets&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 8, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [], 
   &quot;source&quot;: [ 
    &quot;(training, test) = ratings.randomSplit([0.8, 0.2])&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;\n&quot;, 
    &quot;## Show resulting Ratings dataset counts&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 9, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;Total number of ratings = 1000209\n&quot;, 
      &quot;Training dataset count = 800880, 80.07126510559293%\n&quot;, 
      &quot;Test dataset count = 199329, 19.928734894407068%\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;trainingRatio = float(training.count())/float(ratings.count())*100\n&quot;, 
    &quot;testRatio = float(test.count())/float(ratings.count())*100\n&quot;, 
    &quot;\n&quot;, 
    &quot;print(\&quot;Total number of ratings = \&quot; + str(ratings.count()))\n&quot;, 
    &quot;print(\&quot;Training dataset count = \&quot; + str(training.count()) + \&quot;, \&quot; + str(trainingRatio) + \&quot;%\&quot;)\n&quot;, 
    &quot;print(\&quot;Test dataset count = \&quot; + str(test.count()) + \&quot;, \&quot; + str(testRatio) + \&quot;%\&quot;)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Build the recommendation model on the training data using ALS&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 10, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [], 
   &quot;source&quot;: [ 
    &quot;als = ALS(maxIter=5, regParam=0.01, userCol=\&quot;userId\&quot;, itemCol=\&quot;movieId\&quot;, ratingCol=\&quot;rating\&quot;,\n&quot;, 
    &quot;          coldStartStrategy=\&quot;drop\&quot;)\n&quot;, 
    &quot;model = als.fit(training)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Run the model against the Test data and show a sample of the predictions&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 11, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;+-------+------+---------+------+----------+\n&quot;, 
      &quot;|movieId|rating|timestamp|userId|prediction|\n&quot;, 
      &quot;+-------+------+---------+------+----------+\n&quot;, 
      &quot;|    148|   1.0|976295338|   840| 2.9349167|\n&quot;, 
      &quot;|    148|   2.0|974875106|  1150| 2.9894443|\n&quot;, 
      &quot;|    148|   2.0|974178993|  2456| 3.9975448|\n&quot;, 
      &quot;|    463|   5.0|968916009|  3151|  3.967182|\n&quot;, 
      &quot;|    463|   3.0|963746396|  4858| 2.0730953|\n&quot;, 
      &quot;|    463|   4.0|973625620|  2629| 3.1774714|\n&quot;, 
      &quot;|    463|   1.0|966523740|  3683| 1.1212827|\n&quot;, 
      &quot;|    463|   2.0|966790403|  3562|  2.780132|\n&quot;, 
      &quot;|    463|   4.0|975775726|   721| 3.3978982|\n&quot;, 
      &quot;|    463|   3.0|965308300|  4252| 0.9944763|\n&quot;, 
      &quot;+-------+------+---------+------+----------+\n&quot;, 
      &quot;only showing top 10 rows\n&quot;, 
      &quot;\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;predictions = model.transform(test).na.drop()\n&quot;, 
    &quot;predictions.show(10)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Evaluate the model by computing the RMSE on the test data&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 12, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;Root-mean-square error = 0.8908929362860674\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;predictions = model.transform(test)\n&quot;, 
    &quot;evaluator = RegressionEvaluator(metricName=\&quot;rmse\&quot;, labelCol=\&quot;rating\&quot;,\n&quot;, 
    &quot;                                predictionCol=\&quot;prediction\&quot;)\n&quot;, 
    &quot;rmse = evaluator.evaluate(predictions)\n&quot;, 
    &quot;print(\&quot;Root-mean-square error = \&quot; + str(rmse))&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Show that a smaller value of rmse is better\n&quot;, 
    &quot;This is obviously the case since RMSE is an aggregation of all the error. Thus evaluator.isLargerBetter should be 'false'.&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 13, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;data&quot;: { 
      &quot;text/plain&quot;: [ 
       &quot;False&quot; 
      ] 
     }, 
     &quot;execution_count&quot;: 13, 
     &quot;metadata&quot;: {}, 
     &quot;output_type&quot;: &quot;execute_result&quot; 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;evaluator.isLargerBetter()&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;## Make movie recommendations&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 14, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [], 
   &quot;source&quot;: [ 
    &quot;# Generate top 10 movie recommendations for each user\n&quot;, 
    &quot;userRecs = model.recommendForAllUsers(10)\n&quot;, 
    &quot;# Generate top 10 user recommendations for each movie\n&quot;, 
    &quot;movieRecs = model.recommendForAllItems(10)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;# Show sample recommendations per user&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 15, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;|userId|recommendations                                                                                                                                                               |\n&quot;, 
      &quot;+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;|148   |[[1780,7.2854385], [1369,6.99533], [666,6.6703053], [2892,6.5549903], [1741,6.528875], [3523,6.07751], [572,6.003775], [2127,5.859668], [1164,5.6353364], [649,5.5918784]]    |\n&quot;, 
      &quot;|5173  |[[3245,7.7563887], [1038,7.52281], [3867,7.2047706], [632,7.0838833], [37,7.0073814], [751,6.936385], [1369,6.471981], [645,6.453275], [1664,6.23118], [1543,6.188328]]       |\n&quot;, 
      &quot;|5695  |[[1458,9.663776], [3855,9.074218], [3106,9.053921], [2837,9.043263], [2192,8.797422], [2397,8.7831135], [341,8.623167], [1511,8.611192], [3636,8.600376], [219,8.446543]]     |\n&quot;, 
      &quot;|1863  |[[962,6.392259], [2175,6.2921085], [2984,6.027778], [759,5.9641767], [3737,5.929455], [2284,5.917394], [2426,5.894059], [854,5.883927], [2209,5.847718], [2705,5.8452163]]    |\n&quot;, 
      &quot;|1924  |[[1038,8.618518], [219,7.9083204], [131,7.871811], [632,7.788521], [1458,7.681244], [1574,7.473834], [119,7.1832986], [1696,7.0665197], [1312,6.7171383], [1651,6.703975]]    |\n&quot;, 
      &quot;|4610  |[[3670,6.8609476], [1117,6.645418], [2994,6.6018786], [2830,6.596518], [2934,6.505612], [3851,6.3677354], [2512,6.349237], [106,6.3229113], [2933,6.315516], [96,6.302059]]   |\n&quot;, 
      &quot;|4104  |[[649,7.115762], [1421,6.597936], [3885,6.493393], [1585,6.441885], [1741,6.0131593], [503,5.8390074], [3847,5.8177996], [443,5.6730995], [2624,5.634462], [3749,5.602259]]   |\n&quot;, 
      &quot;|1249  |[[3636,8.443559], [1420,7.907082], [1664,7.8959613], [3456,7.7776465], [2697,7.7743106], [702,7.7192597], [2825,7.573881], [2933,7.547401], [3900,7.4978175], [645,7.3760333]]|\n&quot;, 
      &quot;|855   |[[3670,5.6403356], [557,5.452341], [503,4.9971642], [3338,4.9897413], [3012,4.9187536], [2830,4.8673472], [1664,4.8444023], [3851,4.840315], [572,4.8038983], [2934,4.760828]]|\n&quot;, 
      &quot;|5361  |[[3523,8.854711], [1662,7.23445], [2388,7.046192], [1780,6.9375844], [2892,6.929945], [2164,6.6275907], [1117,6.4804296], [1846,6.458152], [131,6.426946], [2962,6.3652472]]  |\n&quot;, 
      &quot;+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;only showing top 10 rows\n&quot;, 
      &quot;\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;userRecs.sample(False, 0.01).show(10, False)&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;markdown&quot;, 
   &quot;metadata&quot;: {}, 
   &quot;source&quot;: [ 
    &quot;# Show sample recommendations per user&quot; 
   ] 
  }, 
  { 
   &quot;cell_type&quot;: &quot;code&quot;, 
   &quot;execution_count&quot;: 16, 
   &quot;metadata&quot;: {}, 
   &quot;outputs&quot;: [ 
    { 
     &quot;name&quot;: &quot;stdout&quot;, 
     &quot;output_type&quot;: &quot;stream&quot;, 
     &quot;text&quot;: [ 
      &quot;+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;|movieId|recommendations                                                                                                                                                                |\n&quot;, 
      &quot;+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;|3844   |[[1213,7.3201046], [2441,6.9640417], [5297,6.8789372], [2549,6.8698826], [2816,6.507644], [1971,6.458085], [2160,6.4162674], [3915,6.402381], [4544,6.17197], [2560,6.119645]] |\n&quot;, 
      &quot;|1031   |[[1070,5.9382234], [4143,5.8492775], [3897,5.841146], [2755,5.6947303], [4282,5.6827908], [527,5.6089225], [1728,5.5674863], [5052,5.52997], [5983,5.419548], [1459,5.4131107]]|\n&quot;, 
      &quot;|26     |[[1213,7.0531287], [2640,6.3756685], [879,6.1351347], [2502,6.0931673], [5298,5.9518814], [642,5.873951], [1808,5.86157], [6038,5.8189907], [2535,5.804851], [2755,5.7891493]] |\n&quot;, 
      &quot;|626    |[[4504,9.705521], [3222,8.426963], [1713,8.153491], [5863,7.892766], [4583,7.852765], [3113,7.608546], [4776,7.5394926], [206,7.5082846], [2713,7.271112], [4008,7.1363134]]   |\n&quot;, 
      &quot;|3752   |[[5670,6.538592], [21,5.9881763], [5258,5.949679], [4393,5.7138], [4028,5.6019115], [1025,5.459873], [5877,5.4184914], [87,5.411454], [2357,5.375736], [5462,5.3705955]]       |\n&quot;, 
      &quot;|2256   |[[745,7.8676734], [2469,7.4058766], [906,7.213084], [2431,7.1617584], [1754,7.1158795], [5030,7.11016], [3911,6.9476233], [527,6.4272637], [700,6.3252373], [1713,6.281575]]   |\n&quot;, 
      &quot;|3793   |[[640,5.7342196], [5218,5.440282], [1673,5.2526026], [947,5.2225814], [2694,5.2105126], [2879,5.199566], [768,5.188442], [115,5.168048], [527,5.159202], [4936,5.1525726]]     |\n&quot;, 
      &quot;|2867   |[[745,5.992924], [2534,5.8074617], [527,5.6805005], [2755,5.653826], [283,5.3882546], [3587,5.3234334], [3902,5.3050156], [246,5.27825], [5440,5.2693644], [3373,5.2450128]]   |\n&quot;, 
      &quot;|846    |[[4008,10.775237], [4504,10.658872], [3222,9.88133], [399,9.678963], [5240,9.402692], [144,9.301779], [653,9.236071], [734,9.1837225], [2191,8.888657], [1014,8.74862]]        |\n&quot;, 
      &quot;|729    |[[665,11.115968], [1459,9.497441], [5803,7.76634], [1384,7.726793], [4317,7.657247], [640,7.6146173], [4427,7.6077237], [3870,7.5751157], [3463,7.331725], [3186,6.939564]]    |\n&quot;, 
      &quot;+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n&quot;, 
      &quot;only showing top 10 rows\n&quot;, 
      &quot;\n&quot; 
     ] 
    } 
   ], 
   &quot;source&quot;: [ 
    &quot;movieRecs.sample(False, 0.01).show(10, False)&quot; 
   ] 
  } 
 ], 
 &quot;metadata&quot;: { 
  &quot;kernelspec&quot;: { 
   &quot;display_name&quot;: &quot;Python 3&quot;, 
   &quot;language&quot;: &quot;python&quot;, 
   &quot;name&quot;: &quot;python3&quot; 
  }, 
  &quot;language_info&quot;: { 
   &quot;codemirror_mode&quot;: { 
    &quot;name&quot;: &quot;ipython&quot;, 
    &quot;version&quot;: 3.0 
   }, 
   &quot;file_extension&quot;: &quot;.py&quot;, 
   &quot;mimetype&quot;: &quot;text/x-python&quot;, 
   &quot;name&quot;: &quot;python&quot;, 
   &quot;nbconvert_exporter&quot;: &quot;python&quot;, 
   &quot;pygments_lexer&quot;: &quot;ipython3&quot;, 
   &quot;version&quot;: &quot;3.6.2&quot; 
  } 
 }, 
 &quot;nbformat&quot;: 4, 
 &quot;nbformat_minor&quot;: 0 
}</span></pre>
</body>
</html>